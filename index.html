<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êµ∑ÊãâÁöÑÈí±ÂåÖ - ÊäΩÂç°ËµÑÊ∫êËÆ°ÁÆóÂô®</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Âü∫Á°ÄÊ†∑Âºè */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .gacha-calculator {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        .calculator-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }
        
        .left-panel, .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            width: 100%;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
            user-select: none;
        }
        
        .section-header:hover {
            color: #1890ff;
        }
        
        .collapse-icon {
            font-weight: bold;
            font-size: 16px;
            color: #666;
        }
        
        .section-content {
            margin-top: 10px;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .sub-section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #1890ff;
        }
        
        .sub-title {
            color: #333;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: bold;
        }
        
        /* Â∑¶‰æßÈù¢ÊùøÂõ∫ÂÆöÂÆö‰Ωç */
        .sticky-panel {
            position: sticky;
            top: 20px;
            align-self: flex-start;
            z-index: 10;
        }
        
        /* ÂÜªÁªìÈ°∂ÈÉ®ÁªüËÆ°Ê®°Âùó */
        .time-total-section {
            position: sticky;
            top: 0;
            z-index: 100;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* ÂΩìÂâçÂ∫ìÂ≠òÂûÇÁõ¥Â∏ÉÂ±Ä */
        .resource-vertical {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
        }
        
        .resource-input-vertical {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }
        
        .resource-input-vertical label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            color: #555;
            min-width: 120px;
            margin-bottom: 0;
        }
        
        .resource-input-vertical input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 100px;
            text-align: center;
        }
        
        /* ÁöÆËÇ§È¢ÑÁïô‰∏ÄË°åÊòæÁ§∫ */
        .skin-reserve-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        
        .skin-item.compact {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 12px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }
        
        .skin-item.compact .skin-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .skin-item.compact .skin-price {
            font-weight: bold;
            color: #333;
        }
        
        .skin-item.compact .skin-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .skin-item.compact .skin-count {
            color: #1890ff;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
        }
        
        .skin-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .skin-btn:hover {
            background: #f0f0f0;
        }
        
        .skin-btn:active {
            background: #e0e0e0;
        }
        
        /* ÊöóÂüüÂºÄÂÖ≥ÁªÑÊ†∑Âºè */
        .dark-zone-switches {
            display: flex;
            gap: 15px;
        }
        
        /* Êï∞ÊçÆÈó¥ÈöôÊ†∑Âºè */
        .data-gap-subsection {
            margin: 15px 0;
            padding: 12px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }
        
        .data-gap-title {
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .target-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .rating-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .target-btn, .rating-btn {
            padding: 10px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .target-btn:hover, .rating-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .target-btn.active, .rating-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        /* Êó∂Èó¥ÈÄâÈ°πÊ†∑Âºè */
        .time-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .time-option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
        }
        
        .time-option.active {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .time-days {
            font-size: 18px;
            font-weight: bold;
            color: #1890ff;
            margin: 5px 0;
        }
        
        .time-weeks {
            font-size: 14px;
            color: #666;
            font-weight: normal;
        }
        
        /* ÂºÄÂÖ≥Ê†∑Âºè */
        .switch-group {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        
        .switch-group.small {
            margin: 0 0 0 10px;
        }
        
        .switch {
            position: relative;
            width: 40px;
            height: 20px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #1890ff;
        }
        
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .switch-label {
            font-size: 12px;
            margin-left: 5px;
            color: #666;
        }
        
        /* ÁßØÁ¥ØÈ°πÊ†∑Âºè */
        .accumulation-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 8px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .item-info {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .item-title {
            font-weight: bold;
            color: #333;
            min-width: 120px;
        }
        
        .item-subtitle {
            color: #666;
            min-width: 80px;
            font-size: 14px;
        }
        
        .item-value {
            font-weight: bold;
            color: #1890ff;
            margin-left: 10px;
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        /* ËµÑÊ∫êÂõæÊ†áÊ†∑Âºè */
        .resource-icon {
            width: 24px;
            height: 24px;
            vertical-align: middle;
            margin: 0 2px;
        }
        
        .resource-icon.small {
            width: 16px;
            height: 16px;
        }
        
        /* ÂïÜÂ∫óÊ†∑Âºè */
        .shop-section {
            margin-top: 15px;
            padding: 15px;
            background: #e8f4fd;
            border-radius: 8px;
        }
        
        .shop-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .certification-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .certification-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .certification-btn:hover {
            background: #f0f0f0;
        }
        
        .certification-count {
            font-weight: bold;
            color: #ffa500;
            min-width: 80px;
            text-align: center;
        }
        
        /* ËÆ≠ÁªÉÊåâÈíÆÊ†∑Âºè */
        .training-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .training-btn {
            padding: 12px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .training-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .training-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        /* È•ºÁä∂ÂõæÊ†∑Âºè */
        .summary-chart-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: center;
            margin-top: 15px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 200px;
        }
        
        .chart-legend {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .legend-item:hover {
            background-color: #f5f5f5;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }
        
        .legend-text {
            font-size: 12px;
            color: #333;
        }
        
        .chart-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            display: none;
        }
        
        /* Êñ∞ÁöÑÊÄªËÆ°Ê®°ÂùóÊ†∑Âºè */
        .total-summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .summary-category {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #1890ff;
        }
        
        .category-name {
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }
        
        .category-value {
            font-weight: bold;
            color: #1890ff;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* ÁßªÂä®Á´ØÂõ∫ÂÆöÂÆö‰Ωç */
        .sticky-total-mobile {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        /* Êñ∞Â¢ûÊ®°ÂùóÊ†∑Âºè */
        .new-module-section {
            margin-top: 20px;
        }
        
        /* Êó†Â∞ΩÊ¢¶È≠áÁßØÂàÜÊ†∑Âºè */
        .nightmare-score {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }
        
        .score-title {
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .slider-container {
            margin-bottom: 15px;
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 12px;
            color: #666;
        }
        
        .score-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        
        .score-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1890ff;
            cursor: pointer;
        }
        
        .score-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1890ff;
            cursor: pointer;
            border: none;
        }
        
        .slider-value {
            text-align: center;
            font-size: 12px;
            color: #1890ff;
            margin-top: 5px;
            font-weight: bold;
        }
        
        .score-rewards {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .reward-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .reward-label {
            font-size: 13px;
            color: #333;
        }
        
        .reward-value {
            font-size: 13px;
            font-weight: bold;
            color: #1890ff;
        }
        
        /* ËßíËâ≤ÂÖªÊàêÊ®°ÂùóÊ†∑Âºè */
        .character-development-inputs {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
        }
        
        .character-development-input {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }
        
        .character-development-input label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            color: #555;
            min-width: 200px;
            margin-bottom: 0;
        }
        
        .character-development-input input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 80px;
            text-align: center;
        }
        
        .character-development-btn {
            padding: 10px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-top: 5px;
        }
        
        .character-development-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .character-development-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        /* Ê®°ÂùóÂºÄÂÖ≥Ê†∑Âºè */
        .module-switch {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }
        
        .module-switch-label {
            font-size: 12px;
            color: #666;
            white-space: nowrap;
        }
        
        /* Êñ∞Â¢ûÊ®°ÂùóÊåâÈíÆÊ†∑Âºè */
        .main-story-buttons {
            margin-top: 10px;
        }
        
        .main-story-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .main-story-column {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .main-story-btn {
            padding: 10px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .main-story-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .main-story-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        /* ÁãÑÊñØÊöóÂΩ±ÔºàEXÔºâÊåâÈíÆÊ†∑Âºè */
        .ex-buttons {
            margin-top: 10px;
        }
        
        .ex-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .ex-column {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .ex-btn {
            padding: 10px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .ex-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .ex-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        .memory-storm-buttons,
        .pollution-nest-buttons,
        .cleanup-operation-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }
        
        .memory-storm-btn,
        .pollution-nest-btn,
        .cleanup-operation-btn {
            padding: 10px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .memory-storm-btn:hover,
        .pollution-nest-btn:hover,
        .cleanup-operation-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .memory-storm-btn.active,
        .pollution-nest-btn.active,
        .cleanup-operation-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        .palma-ruins-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        
        .palma-ruins-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .palma-ruins-btn {
            padding: 10px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .palma-ruins-btn:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .palma-ruins-btn.active {
            border-color: #1890ff;
            background: #1890ff;
            color: white;
        }
        
        /* ÁßªÂä®Á´Ø‰ºòÂÖàÁöÑÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .gacha-calculator {
                padding: 8px;
                min-height: 100vh;
                background: #f5f7fa;
            }
            
            .calculator-layout {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
            
            .left-panel {
                order: -1; /* ÊÄªËÆ°Ê®°ÂùóÁßªÂà∞ÊúÄ‰∏äÈù¢ */
            }
            
            .sticky-panel {
                position: static;
            }
            
            .sticky-total-mobile {
                position: sticky;
                top: 0;
                z-index: 1000;
                background: white;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                margin: -8px -8px 12px -8px;
                border-radius: 0;
                padding: 12px 15px;
            }
            
            .card {
                padding: 16px;
                border-radius: 12px;
                margin-bottom: 8px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                width: 100%; /* Á°Æ‰øùÁßªÂä®Á´ØÂÆΩÂ∫¶‰∏çÂèò */
            }
            
            h1 {
                font-size: 20px;
                margin-bottom: 16px;
                text-align: center;
                padding: 0 10px;
            }
            
            h1 img.resource-icon {
                width: 36px !important;
                height: auto !important;
            }
            
            .section-header {
                font-size: 16px;
                padding: 12px 0;
                margin-bottom: 12px;
                user-select: none;
                -webkit-tap-highlight-color: transparent;
            }
            
            .collapse-icon {
                font-size: 18px;
                min-width: 20px;
                text-align: center;
            }
            
            /* ËµÑÊ∫êËæìÂÖ•‰ºòÂåñ */
            .resource-vertical {
                gap: 12px;
            }
            
            .resource-input-vertical {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
                padding: 12px;
                background: #f8f9fa;
                border-radius: 8px;
                border: 1px solid #e8ecef;
            }
            
            .resource-input-vertical label {
                min-width: auto;
                font-size: 14px;
                font-weight: 600;
                color: #333;
                display: flex;
                align-items: center;
                gap: 6px;
            }
            
            .resource-input-vertical input {
                width: 100%;
                max-width: none;
                min-height: 44px;
                padding: 12px;
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
                border: 1px solid #d0d7de;
                border-radius: 6px;
                background: white;
            }
            
            /* ÁöÆËÇ§È¢ÑÁïôÂå∫Âüü */
            .skin-reserve-row {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            .skin-item.compact {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 12px;
                background: #f8f9fa;
                border: 1px solid #e8ecef;
            }
            
            .skin-item.compact .skin-info {
                flex-direction: row;
                align-items: center;
                gap: 8px;
            }
            
            .skin-item.compact .skin-price {
                font-size: 14px;
                font-weight: 600;
            }
            
            .skin-item.compact .skin-controls {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .skin-btn {
                min-width: 44px;
                min-height: 44px;
                width: 44px;
                height: 44px;
                border: 1px solid #d0d7de;
                background: white;
                border-radius: 6px;
                font-size: 18px;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                -webkit-tap-highlight-color: transparent;
            }
            
            .skin-count {
                min-width: 50px;
                text-align: center;
                font-weight: 600;
                font-size: 14px;
            }
            
            /* ÊåâÈíÆÁªÑ‰ºòÂåñ */
            .target-buttons,
            .rating-buttons,
            .memory-storm-buttons,
            .pollution-nest-buttons,
            .cleanup-operation-buttons {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }
            
            .main-story-buttons,
            .ex-buttons {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }
            
            .main-story-columns,
            .ex-columns {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }
            
            .palma-ruins-buttons {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }
            
            .palma-ruins-row {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }
            
            /* ÈÄöÁî®ÊåâÈíÆÊ†∑Âºè */
            .target-btn, .rating-btn, .main-story-btn, .ex-btn,
            .memory-storm-btn, .pollution-nest-btn, .cleanup-operation-btn,
            .palma-ruins-btn, .character-development-btn {
                min-height: 48px;
                padding: 12px 10px;
                font-size: 14px;
                border: 2px solid #e8ecef;
                border-radius: 8px;
                background: white;
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
                line-height: 1.3;
                -webkit-tap-highlight-color: transparent;
                transition: all 0.2s ease;
            }
            
            .target-btn:hover, .rating-btn:hover, .main-story-btn:hover, .ex-btn:hover,
            .memory-storm-btn:hover, .pollution-nest-btn:hover, .cleanup-operation-btn:hover,
            .palma-ruins-btn:hover, .character-development-btn:hover {
                border-color: #1890ff;
                background: #f0f8ff;
            }
            
            .target-btn.active, .rating-btn.active, .main-story-btn.active, .ex-btn.active,
            .memory-storm-btn.active, .pollution-nest-btn.active, .cleanup-operation-btn.active,
            .palma-ruins-btn.active, .character-development-btn.active {
                border-color: #1890ff;
                background: #1890ff;
                color: white;
            }
            
            /* Êó∂Èó¥ÈÄâÈ°π‰ºòÂåñ */
            .time-options {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
            
            .time-option {
                padding: 16px;
                border: 2px solid #e8ecef;
                border-radius: 10px;
                text-align: center;
                -webkit-tap-highlight-color: transparent;
            }
            
            .time-option.active {
                border-color: #1890ff;
                background: #f0f8ff;
            }
            
            /* ÂõæË°®‰ºòÂåñ */
            .summary-chart-container {
                display: flex;
                flex-direction: column;
                gap: 16px;
            }
            
            .chart-wrapper {
                height: 200px;
                position: relative;
            }
            
            .chart-legend {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                gap: 10px;
                padding: 8px;
                border-radius: 6px;
                -webkit-tap-highlight-color: transparent;
            }
            
            /* ÊÄªËÆ°ÁΩëÊ†º‰ºòÂåñ */
            .total-summary-grid {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            .summary-category {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px;
                background: #f8f9fa;
                border-radius: 8px;
                border-left: 4px solid #1890ff;
            }
            
            .category-name {
                font-size: 14px;
                font-weight: 600;
            }
            
            .category-value {
                font-size: 14px;
                font-weight: 600;
                display: flex;
                align-items: center;
                gap: 4px;
            }
            
            /* Â≠êÂå∫Âüü‰ºòÂåñ */
            .sub-section {
                margin: 16px 0;
                padding: 16px;
                background: #f8f9fa;
                border-radius: 10px;
                border-left: 4px solid #1890ff;
            }
            
            .sub-title {
                font-size: 15px;
                font-weight: 600;
                margin-bottom: 12px;
                color: #333;
            }
            
            /* ÂºÄÂÖ≥ÁªÑ‰ºòÂåñ */
            .switch-group {
                display: flex;
                align-items: center;
                margin: 12px 0;
                padding: 8px 0;
            }
            
            .switch-group.small {
                margin: 0;
                padding: 0;
            }
            
            .switch {
                min-width: 44px;
                height: 24px;
            }
            
            .switch-label {
                font-size: 14px;
                margin-left: 8px;
                color: #666;
            }
            
            /* ÁßØÁ¥ØÈ°π‰ºòÂåñ */
            .accumulation-item {
                display: flex;
                flex-direction: column;
                gap: 8px;
                margin: 10px 0;
                padding: 12px;
                background: white;
                border-radius: 8px;
                border: 1px solid #e8ecef;
            }
            
            .item-info {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .item-title {
                font-size: 14px;
                font-weight: 600;
            }
            
            .item-value {
                font-size: 14px;
                font-weight: 600;
                display: flex;
                align-items: center;
                gap: 4px;
            }
            
            /* ËßíËâ≤ÂÖªÊàêËæìÂÖ•‰ºòÂåñ */
            .character-development-inputs {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
            
            .character-development-input {
                display: flex;
                flex-direction: column;
                gap: 8px;
                padding: 12px;
                background: white;
                border-radius: 8px;
                border: 1px solid #e8ecef;
            }
            
            .character-development-input label {
                min-width: auto;
                font-size: 14px;
                font-weight: 600;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .character-development-input input {
                min-height: 44px;
                padding: 12px;
                font-size: 16px;
                border: 1px solid #d0d7de;
                border-radius: 6px;
                text-align: center;
            }
            
            /* Êó†Â∞ΩÊ¢¶È≠áÊªëÂùó‰ºòÂåñ */
            .nightmare-score {
                padding: 16px;
                background: white;
                border-radius: 8px;
                border: 1px solid #e8ecef;
            }
            
            .score-slider {
                width: 100%;
                height: 8px;
                border-radius: 4px;
                -webkit-appearance: none;
                background: #e8ecef;
            }
            
            .score-slider::-webkit-slider-thumb {
                -webkit-appearance: none;
                width: 24px;
                height: 24px;
                border-radius: 50%;
                background: #1890ff;
                border: 2px solid white;
                box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            }
            
            /* Ê®°ÂùóÂºÄÂÖ≥‰ºòÂåñ */
            .module-switch {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-left: auto;
            }
            
            .module-switch-label {
                font-size: 12px;
                color: #666;
                white-space: nowrap;
            }
            
            /* ËµÑÊ∫êÂõæÊ†á‰ºòÂåñ */
            .resource-icon {
                width: 20px;
                height: 20px;
            }
            
            .resource-icon.small {
                width: 14px;
                height: 14px;
            }
            
            /* Á°Æ‰øùÊñáÊú¨‰∏ç‰ºöÊ∫¢Âá∫ */
            .main-story-btn, .ex-btn {
                white-space: normal;
                word-wrap: break-word;
                line-height: 1.3;
            }
        }
        
        /* Ë∂ÖÂ∞èÂ±èÂπïÈ¢ùÂ§ñ‰ºòÂåñ */
        @media (max-width: 360px) {
            .gacha-calculator {
                padding: 6px;
            }
            
            .card {
                padding: 12px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .section-header {
                font-size: 15px;
            }
            
            .target-btn, .rating-btn, .main-story-btn, .ex-btn,
            .memory-storm-btn, .pollution-nest-btn, .cleanup-operation-btn,
            .palma-ruins-btn, .character-development-btn {
                font-size: 13px;
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="gacha-calculator">
            <h1><img src="icons/hl.gif" class="resource-icon" alt="Êµ∑Êãâ" style="width: 48px; height: auto;"> Êµ∑ÊãâÁöÑÈí±ÂåÖ</h1>
            
            <div class="calculator-layout">
                <!-- Â∑¶‰æßÔºöÂêàÂπ∂ÂêéÁöÑÂç°Ê±†Êó∂Èó¥ÂíåÊÄªËÆ°Ê®°Âùó -->
                <div class="left-panel sticky-panel">
                    <!-- ÂêàÂπ∂ÂêéÁöÑÂç°Ê±†Êó∂Èó¥ÂíåÊÄªËÆ°Ê®°Âùó -->
                    <div class="time-total-section card" :class="{ 'sticky-total-mobile': isMobile }">
                        <h2 @click="toggleSection('timeTotal')" class="section-header">
                            üìä ÂÖ±ËÆ°{{ totalPulls }}ÊäΩÔºåÊ∞™Èáë{{ totalMoney }}ÂÖÉ
                            <span class="collapse-icon">{{ sections.timeTotal ? '‚àí' : '+' }}</span>
                        </h2>
                        
                        <div v-if="sections.timeTotal" class="section-content">
                            <!-- Âç°Ê±†Êó∂Èó¥ÂÜÖÂÆπ -->
                            <div class="time-section">
                                <div class="switch-group">
                                    <label class="switch">
                                        <input type="checkbox" v-model="calculateToPoolEnd">
                                        <span class="slider"></span>
                                    </label>
                                    <span class="switch-label">
                                        {{ calculateToPoolEnd ? 'ËÆ°ÁÆóÂà∞Âç°Ê±†ÁªìÊùüÂΩìÂ§©' : 'ËÆ°ÁÆóÂà∞Âç°Ê±†ÂºÄÊîæÂΩìÂ§©' }}
                                    </span>
                                </div>
                                
                                <div class="time-options">
                                    <div class="time-option" 
                                         :class="{ active: selectedTime === 'nextVersion' }"
                                         @click="selectedTime = 'nextVersion'">
                                        <div class="time-title">‰∏ãÁâàÊú¨</div>
                                        <div class="time-date">2025Âπ¥11Êúà20Êó•</div>
                                        <div class="time-days">Ââ©‰Ωô {{ daysToNextVersion }} Â§©</div>
                                        <div class="time-weeks">ÊåÅÁª≠ {{ versionWeeks }} Âë®</div>
                                    </div>
                                    
                                    <div class="time-option" 
                                         :class="{ active: selectedTime === 'newYear' }"
                                         @click="selectedTime = 'newYear'">
                                        <div class="time-title">Êñ∞Âπ¥ÁâàÊú¨</div>
                                        <div class="time-date">2026Âπ¥2Êúà17Êó•</div>
                                        <div class="time-days">Ââ©‰Ωô {{ daysToNewYear }} Â§©</div>
                                        <div class="time-weeks">ÊåÅÁª≠ {{ versionWeeks }} Âë®</div>
                                    </div>
                                </div>
                            </div>

                            <!-- È•ºÁä∂ÂõæÂíåÂàÜÁ±ªÊ±áÊÄª -->
                            <div class="summary-chart-container">
                                <!-- È•ºÁä∂Âõæ -->
                                <div class="chart-wrapper">
                                    <canvas ref="pieChart"></canvas>
                                    <div class="chart-tooltip" ref="chartTooltip"></div>
                                </div>
                                
                                <!-- Âõæ‰æã -->
                                <div class="chart-legend">
                                    <div class="legend-item" v-for="(category, index) in summaryCategories" 
                                         :key="category.key"
                                         @mouseenter="showTooltip(category)"
                                         @mouseleave="hideTooltip">
                                        <div class="legend-color" :style="{ backgroundColor: categoryColors[index] }"></div>
                                        <span class="legend-text">{{ category.label }}: {{ category.pulls }}ÊäΩ ({{ category.percentage }}%)</span>
                                    </div>
                                </div>
                            </div>

                            <!-- ÂàÜÁ±ªËØ¶ÁªÜÊï∞ÊçÆ -->
                            <div class="total-summary-grid">
                                <div class="summary-category" v-for="category in summaryCategories" :key="category.key">
                                    <span class="category-name">{{ category.label }}Ôºö</span>
                                    <span class="category-value">
                                        <template v-if="category.key === 'current'">
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">{{ formatNumber(category.crystal) }}Ôºà{{ category.pulls }}ÊäΩÔºâ
                                        </template>
                                        <template v-else-if="category.key === 'daily'">
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">{{ formatNumber(category.crystal) }}Ôºà{{ category.pulls }}ÊäΩÔºâ
                                        </template>
                                        <template v-else-if="category.key === 'activity'">
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">{{ formatNumber(category.crystal) }}Ôºà{{ category.pulls }}ÊäΩÔºâ
                                        </template>
                                        <template v-else-if="category.key === 'potential'">
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">{{ formatNumber(category.crystal) }}Ôºà{{ category.pulls }}ÊäΩÔºâ
                                        </template>
                                        <template v-else-if="category.key === 'recharge'">
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">{{ formatNumber(category.crystal) }}Ôºà{{ category.pulls }}ÊäΩÔºâ
                                        </template>
                                        <template v-else-if="category.key === 'other'">
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">{{ formatNumber(category.crystal) }}Ôºà{{ category.pulls }}ÊäΩÔºâ
                                        </template>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Âè≥‰æßÔºöÂΩìÂâçËµÑÊ∫êÂíåÊó•Â∏∏ÁßØÁ¥Ø -->
                <div class="right-panel">
                    <!-- ÂΩìÂâçËµÑÊ∫êÊ®°Âùó -->
                    <div class="input-section card">
                        <h2 @click="toggleSection('resources')" class="section-header">
                            üíé ÂΩìÂâçËµÑÊ∫ê
                            <span class="collapse-icon">{{ sections.resources ? '‚àí' : '+' }}</span>
                        </h2>
                        <div v-if="sections.resources" class="section-content">
                            <!-- ÂΩìÂâçÂ∫ìÂ≠ò -->
                            <div class="sub-section">
                                <h3 class="sub-title">ÂΩìÂâçÂ∫ìÂ≠ò</h3>
                                <div class="switch-group">
                                    <label class="switch">
                                        <input type="checkbox" v-model="usePremiumCrystal">
                                        <span class="slider"></span>
                                    </label>
                                    <span class="switch-label">‰ΩøÁî®ÁíÄÁí®Êô∂Ê∫êÊäΩÂç°</span>
                                </div>
                                <div class="resource-vertical">
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> ÂºÇÊñπÊô∂Ôºö
                                        </label>
                                        <input type="number" v-model.number="resources.crystal" placeholder="0" min="0">
                                    </div>
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/premium_crystal.png" class="resource-icon" alt="ÁíÄÁí®Êô∂Ê∫ê"> ÁíÄÁí®Êô∂Ê∫êÔºö
                                        </label>
                                        <input type="number" v-model.number="resources.premiumCrystal" placeholder="0" min="0">
                                    </div>
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§"> ÊêúÁ¥¢‰ª§Ôºö
                                        </label>
                                        <input type="number" v-model.number="resources.tickets" placeholder="0" min="0">
                                    </div>
                                </div>
                            </div>

                            <!-- ÁöÆËÇ§È¢ÑÁïôÁ∫¢Êô∂ -->
                            <div class="sub-section">
                                <h3 class="sub-title">ÁöÆËÇ§È¢ÑÁïôÁ∫¢Êô∂</h3>
                                <div class="skin-reserve-row">
                                    <div class="skin-item compact">
                                        <div class="skin-info">
                                            <span class="skin-price">‚úß‚úß880<img src="icons/red_crystal.png" class="resource-icon small" alt="Á∫¢Êô∂"></span>
                                        </div>
                                        <div class="skin-controls">
                                            <button class="skin-btn" @click="adjustSkinCount(880, -1)">‚àí</button>
                                            <span class="skin-count">{{ skinReserve.skin880 }} ‰∏™</span>
                                            <button class="skin-btn" @click="adjustSkinCount(880, 1)">+</button>
                                        </div>
                                    </div>
                                    <div class="skin-item compact">
                                        <div class="skin-info">
                                            <span class="skin-price">‚úß‚úß‚úß1280<img src="icons/red_crystal.png" class="resource-icon small" alt="Á∫¢Êô∂"></span>
                                        </div>
                                        <div class="skin-controls">
                                            <button class="skin-btn" @click="adjustSkinCount(1280, -1)">‚àí</button>
                                            <span class="skin-count">{{ skinReserve.skin1280 }} ‰∏™</span>
                                            <button class="skin-btn" @click="adjustSkinCount(1280, 1)">+</button>
                                        </div>
                                    </div>
                                    <div class="skin-item compact">
                                        <div class="skin-info">
                                            <span class="skin-price">‚úß‚úß‚úß‚úß2580<img src="icons/red_crystal.png" class="resource-icon small" alt="Á∫¢Êô∂"></span>
                                        </div>
                                        <div class="skin-controls">
                                            <button class="skin-btn" @click="adjustSkinCount(2580, -1)">‚àí</button>
                                            <span class="skin-count">{{ skinReserve.skin2580 }} ‰∏™</span>
                                            <button class="skin-btn" @click="adjustSkinCount(2580, 1)">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Ëá™ÂÆö‰πâ‰øÆÊ≠£ -->
                            <div class="sub-section">
                                <h3 class="sub-title">Ëá™ÂÆö‰πâ‰øÆÊ≠£</h3>
                                <div class="resource-input-vertical">
                                    <label>
                                        <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">Êï∞Èáè‰øÆÊ≠£Ôºö
                                    </label>
                                    <input type="number" v-model.number="customAdjustment" placeholder="0" step="1">
                                </div>
                                <div style="font-size: 12px; color: #1890ff; margin-top: 5px; font-style: italic;">
                                    ‰æãÂ¶ÇÂÖ≥Âç°Êú™ÊâìÊª°„ÄÅÁªôÂ§çÂàªÊ±†È¢ÑÁïôÊàñÂÖ∂ÂÆÉÂºÇÊñπÊô∂Êù•Ê∫êÁ≠âÔºåÂèØÂ°´Ë¥üÊï∞
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Êó•Â∏∏ÁßØÁ¥ØÊ®°Âùó -->
                    <div class="daily-section card">
                        <h2 @click="toggleSection('daily')" class="section-header">
                            üìà Êó•Â∏∏ÁßØÁ¥ØÔºàÊõ¥ÊõøÔºâ
                            <span class="collapse-icon">{{ sections.daily ? '‚àí' : '+' }}</span>
                        </h2>
                        <div v-if="sections.daily" class="section-content">
                            <!-- ÂéüÊúâÊó•Â∏∏ÁßØÁ¥ØÂÜÖÂÆπ -->
                            <div class="sub-section">
                                <h3 class="sub-title">Ê¥ªË∑ÉÂ•ñÂä±</h3>
                                <div class="accumulation-item">
                                    <div class="item-info">
                                        <span class="item-title">Êó•Â∏∏{{ selectedDays }}Â§©Ôºö</span>
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ dailyActiveTotal }} </span>
                                    </div>
                                </div>

                                <div class="accumulation-item">
                                    <div class="item-info">
                                        <span class="item-title">Âë®Â∏∏{{ remainingWeeklyCount }}Âë®Ôºö</span>
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ remainingWeeklyTotal }} </span>
                                    </div>
                                    <div class="switch-group small">
                                        <label class="switch">
                                            <input type="checkbox" v-model="weeklyCompleted">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="switch-label">Êú¨Âë®Â∑≤ÂÆåÊàê</span>
                                    </div>
                                </div>

                                <div class="accumulation-item">
                                    <div class="item-info">
                                        <span class="item-title">ÂàÜ‰∫´{{ remainingShareWeeks }}Âë®Ôºö</span>
                                        <span class="item-value"> <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ remainingShareTotal }} </span>
                                    </div>
                                    <div class="switch-group small">
                                        <label class="switch">
                                            <input type="checkbox" v-model="dailyShareCompleted">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="switch-label">Êú¨Âë®Â∑≤ÂàÜ‰∫´</span>
                                    </div>
                                </div>

                                <div class="accumulation-item">
                                    <div class="item-info">
                                        <span class="item-title">ÊÉÖÁª™Ê£ÄÊµãÔºö</span>
                                        <span class="item-value">
                                            <template v-if="!emotionDetectionCompleted">
                                                <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">50 <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </template>
                                            <template v-else><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">0 <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">0</template>
                                        </span>
                                    </div>
                                    <div class="switch-group small">
                                        <label class="switch">
                                            <input type="checkbox" v-model="emotionDetectionCompleted">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="switch-label">Êú¨ÊúàÂ∑≤ÂÆåÊàê</span>
                                    </div>
                                </div>
                            </div>

                            <!-- ÂÖ∂‰ªñÂéüÊúâÊó•Â∏∏ÁßØÁ¥ØÂÜÖÂÆπ‰øùÊåÅ‰∏çÂèò -->
                        </div>
                    </div>

                    <!-- Êñ∞Â¢ûÔºöÊ¥ªÂä®Ôºà‰º∞ÁÆóÔºâÊ®°Âùó -->
                    <div class="activity-section card new-module-section">
                        <h2 @click="toggleSection('activity')" class="section-header">
                            üéØ Ê¥ªÂä®Ôºà‰º∞ÁÆóÔºâ
                            <span class="collapse-icon">{{ sections.activity ? '‚àí' : '+' }}</span>
                        </h2>
                        <div v-if="sections.activity" class="section-content">
                            <div class="sub-section">
                                <h3 class="sub-title">Ê¥ªÂä®ËµÑÊ∫ê‰º∞ÁÆó</h3>
                                <div class="resource-vertical">
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> Ê¥ªÂä®ÂºÇÊñπÊô∂Ôºö
                                        </label>
                                        <input type="number" v-model.number="activityResources.crystal" placeholder="0" min="0">
                                    </div>
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§"> Ê¥ªÂä®ÊêúÁ¥¢‰ª§Ôºö
                                        </label>
                                        <input type="number" v-model.number="activityResources.tickets" placeholder="0" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÊΩúÂú®ËµÑÊ∫êÊ®°Âùó -->
                    <div class="potential-section card">
                        <h2 @click="toggleSection('potential')" class="section-header">
                            üîÆ ÊΩúÂú®ËµÑÊ∫êÔºàÂ∏∏È©ªÔºâ
                            <span class="collapse-icon">{{ sections.potential ? '‚àí' : '+' }}</span>
                        </h2>
                        <div v-if="sections.potential" class="section-content">
                            <!-- Êó†Â∞ΩÊ¢¶È≠áÂ≠êÊ®°Âùó -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">Êó†Â∞ΩÊ¢¶È≠á</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.nightmare">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.nightmare ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                
                                <!-- ÁßØÂàÜÂ•ñÂä± -->
                                <div class="nightmare-score">
                                    <h4 class="score-title">ÁßØÂàÜÂ•ñÂä±</h4>
                                    <div class="slider-container">
                                        <div class="slider-labels">
                                            <span>0</span>
                                            <span>60000</span>
                                        </div>
                                        <input 
                                            type="range" 
                                            v-model.number="nightmareScore" 
                                            min="0" 
                                            max="60000" 
                                            step="1000"
                                            class="score-slider"
                                        >
                                        <div class="slider-value">
                                            ÂΩìÂâçÁßØÂàÜ: {{ nightmareScore }}
                                        </div>
                                    </div>
                                    <div class="score-rewards">
                                        <div class="reward-item">
                                            <span class="reward-label">
                                                <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> 
                                            </span>
                                            <span class="reward-value">{{ nightmareCrystalReward }}</span>
                                        </div>
                                        <div class="reward-item">
                                            <span class="reward-label">
                                                <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§"> 
                                            </span>
                                            <span class="reward-value">{{ nightmareTicketReward }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ËßíËâ≤ÂÖªÊàêÊ®°Âùó -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">ËßíËâ≤ÂÖªÊàê</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.characterDevelopment">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.characterDevelopment ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                
                                <div class="character-development-inputs">
                                    <div class="character-development-input">
                                        <label>
                                            Êú™3Èò∂ËßíËâ≤Êï∞ÈáèÔºö
                                        </label>
                                        <input type="number" v-model.number="characterDevelopment.tier3" placeholder="0" min="0">
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ characterDevelopment.tier3 * 180 }}</span>
                                    </div>
                                    
                                    <div class="character-development-input">
                                        <label>
                                            Êú™Êª°Ê∑∑ÂìçÁãÇÁ∫ßËßíËâ≤Êï∞ÈáèÔºö
                                        </label>
                                        <input type="number" v-model.number="characterDevelopment.maxReverbS" placeholder="0" min="0">
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ characterDevelopment.maxReverbS * 210 }}</span>
                                    </div>
                                    
                                    <div class="character-development-input">
                                        <label>
                                            Êú™Êª°Ê∑∑ÂìçÂç±Á∫ßËßíËâ≤Êï∞ÈáèÔºö
                                        </label>
                                        <input type="number" v-model.number="characterDevelopment.maxReverbA" placeholder="0" min="0">
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ characterDevelopment.maxReverbA * 60 }}</span>
                                    </div>
                                    
                                    <div class="character-development-input">
                                        <label>
                                            Êú™Êª°Ê∑∑ÂìçÊôÆÁ∫ßËßíËâ≤Êï∞ÈáèÔºö
                                        </label>
                                        <input type="number" v-model.number="characterDevelopment.maxReverbB" placeholder="0" min="0">
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ characterDevelopment.maxReverbB * 20 }}</span>
                                    </div>
                                    
                                    <div class="character-development-input">
                                        <label>
                                            Êú™ÂÆ°Êü•ÁãÇÁ∫ßËßíËâ≤Êï∞ÈáèÔºö
                                        </label>
                                        <input type="number" v-model.number="characterDevelopment.reviewS" placeholder="0" min="0">
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ characterDevelopment.reviewS * 200 }}</span>
                                    </div>
                                    
                                    <div class="character-development-input">
                                        <label>
                                            Êú™ÂÆ°Êü•Âç±Á∫ßËßíËâ≤Êï∞ÈáèÔºö
                                        </label>
                                        <input type="number" v-model.number="characterDevelopment.reviewA" placeholder="0" min="0">
                                        <span class="item-value"><img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> {{ characterDevelopment.reviewA * 150 }}</span>
                                    </div>
                                    
                                    <button 
                                        class="character-development-btn" 
                                        :class="{ active: characterDevelopment.haila }"
                                        @click="characterDevelopment.haila = !characterDevelopment.haila">
                                        {{ characterDevelopment.haila ? 'Â∑≤ÂÆ°Êü•Êµ∑ÊãâÔºÅ' : 'Êú™ÂÆ°Êü•Êµ∑ÊãâÔºÅ' }}<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">100
                                     </button>
                                </div>
                            </div>

                            <!-- ÁãÑÊñØÂüéÔºà‰∏ªÁ∫øÔºâ -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">ÁãÑÊñØÂüéÔºà‰∏ªÁ∫øÔºâ</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.mainStory">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.mainStory ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                <div class="main-story-buttons">
                                    <div class="main-story-columns">
                                        <div class="main-story-column">
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.chaosBeyondA }"
                                                @click="toggleMainStory('chaosBeyondA')">
                                                01Ê∑∑Ê≤åÂΩºÂ≤∏A<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">895<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.chaosBeyondB }"
                                                @click="toggleMainStory('chaosBeyondB')">
                                                02Ê∑∑Ê≤åÂΩºÂ≤∏B<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1130<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.unownedCavernA }"
                                                @click="toggleMainStory('unownedCavernA')">
                                                03Êó†‰∏ªÂú∞Á™üA<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1075<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.unownedCavernB }"
                                                @click="toggleMainStory('unownedCavernB')">
                                                04Êó†‰∏ªÂú∞Á™üB<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1180<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.kiranSquareA }"
                                                @click="toggleMainStory('kiranSquareA')">
                                                05Â•áÂÖ∞ÂπøÂú∫A<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1165<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.kiranSquareB }"
                                                @click="toggleMainStory('kiranSquareB')">
                                                06Â•áÂÖ∞ÂπøÂú∫B<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1130<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.carnivalA }"
                                                @click="toggleMainStory('carnivalA')">
                                                07ÂòâÂπ¥ÂçéA<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1130<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.carnivalB }"
                                                @click="toggleMainStory('carnivalB')">
                                                08ÂòâÂπ¥ÂçéB<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">835<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.refugeeCampA }"
                                                @click="toggleMainStory('refugeeCampA')">
                                                09ÊµÅÊ∞ëÂØ®A<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1025<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                        </div>
                                        <div class="main-story-column">
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.refugeeCampB }"
                                                @click="toggleMainStory('refugeeCampB')">
                                                10ÊµÅÊ∞ëÂØ®B<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1095<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.muddyDarkTrapA }"
                                                @click="toggleMainStory('muddyDarkTrapA')">
                                                11Ê≤âÊµäÊöóÈò±A<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1130<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.muddyDarkTrapB }"
                                                @click="toggleMainStory('muddyDarkTrapB')">
                                                12Ê≤âÊµäÊöóÈò±B<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">505<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.highTowerBlackRing }"
                                                @click="toggleMainStory('highTowerBlackRing')">
                                                13È´òÂ°îÈªëÁéØ<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1880<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">2
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.darkSurgeA }"
                                                @click="toggleMainStory('darkSurgeA')">
                                                N1ÊöóÊ∂åA<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">905<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.darkSurgeB }"
                                                @click="toggleMainStory('darkSurgeB')">
                                                N2ÊöóÊ∂åB<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">905<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.goldFeastA }"
                                                @click="toggleMainStory('goldFeastA')">
                                                N3Á¢éÈáëÁõõÂÆ¥A<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">800<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                            <button 
                                                class="main-story-btn" 
                                                :class="{ active: mainStory.goldFeastB }"
                                                @click="toggleMainStory('goldFeastB')">
                                                N4Á¢éÈáëÁõõÂÆ¥B<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">1080<img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§">1
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ÁãÑÊñØÊöóÂΩ±ÔºàEXÔºâ -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">ÁãÑÊñØÊöóÂΩ±ÔºàEXÔºâ</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.darkShadowEx">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.darkShadowEx ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                <div class="ex-buttons">
                                    <div class="ex-columns">
                                        <div class="ex-column">
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.chaosBeyond }"
                                                @click="toggleDarkShadowEx('chaosBeyond')">
                                                EX01Ê∑∑Ê≤åÂΩºÂ≤∏¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">720
                                            </button>
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.unownedCavern }"
                                                @click="toggleDarkShadowEx('unownedCavern')">
                                                EX02Êó†‰∏ªÂú∞Á™ü¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">720
                                            </button>
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.kiranSquare }"
                                                @click="toggleDarkShadowEx('kiranSquare')">
                                                EX03Â•áÂÖ∞ÂπøÂú∫¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">590
                                            </button>
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.carnival }"
                                                @click="toggleDarkShadowEx('carnival')">
                                                EX04ÂòâÂπ¥Âçé¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">650
                                            </button>
                                        </div>
                                        <div class="ex-column">
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.highTowerBlackRing }"
                                                @click="toggleDarkShadowEx('highTowerBlackRing')">
                                                EX05È´òÂ°îÈªëÁéØ¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">650
                                            </button>
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.luxuryFeastFog }"
                                                @click="toggleDarkShadowEx('luxuryFeastFog')">
                                                EX06Â•¢ÂÆ¥ÊµìÈõæ¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">650
                                            </button>
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.drowningRainCity }"
                                                @click="toggleDarkShadowEx('drowningRainCity')">
                                                EX07Ê∫∫Èõ®ÂûÇÂüé¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">650
                                            </button>
                                            <button 
                                                class="ex-btn" 
                                                :class="{ active: darkShadowEx.goldFeast }"
                                                @click="toggleDarkShadowEx('goldFeast')">
                                                EX08Á¢éÈáëÁõõÂÆ¥¬∑ÊöóÂΩ±<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">650
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ËÆ∞ÂøÜÈ£éÊö¥ -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">ËÆ∞ÂøÜÈ£éÊö¥</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.memoryStorm">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.memoryStorm ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                <div class="memory-storm-buttons">
                                    <button 
                                        class="memory-storm-btn" 
                                        :class="{ active: memoryStorm.memoryAnomaly }"
                                        @click="toggleMemoryStorm('memoryAnomaly')">
                                        ËÆ∞ÂøÜÁï∏ÁÇπ<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">350
                                    </button>
                                    <button 
                                        class="memory-storm-btn" 
                                        :class="{ active: memoryStorm.impressionAnomaly }"
                                        @click="toggleMemoryStorm('impressionAnomaly')">
                                        Âç∞Ë±°Áï∏ÁÇπ<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">350
                                    </button>
                                    <button 
                                        class="memory-storm-btn" 
                                        :class="{ active: memoryStorm.echoAnomaly }"
                                        @click="toggleMemoryStorm('echoAnomaly')">
                                        ÊÆãÂìçÁï∏ÁÇπ<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">350
                                    </button>
                                </div>
                            </div>

                            <!-- Ê±°Êüì‰πãÂ∑¢ -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">Ê±°Êüì‰πãÂ∑¢</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.pollutionNest">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.pollutionNest ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                <div class="pollution-nest-buttons">
                                    <button 
                                        class="pollution-nest-btn" 
                                        :class="{ active: pollutionNest.forbiddenZoneProbe }"
                                        @click="togglePollutionNest('forbiddenZoneProbe')">
                                        Á¶ÅÂå∫Êé¢Êü•<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">350
                                    </button>
                                    <button 
                                        class="pollution-nest-btn" 
                                        :class="{ active: pollutionNest.extremeDomainSearch }"
                                        @click="togglePollutionNest('extremeDomainSearch')">
                                        ÊûÅÂüüÊêúÂØª<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">210
                                    </button>
                                </div>
                            </div>

                            <!-- Ê∏ÖÂâøË°åÂä® -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">Ê∏ÖÂâøË°åÂä®</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.cleanupOperation">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.cleanupOperation ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                <div class="cleanup-operation-buttons">
                                    <button 
                                        class="cleanup-operation-btn" 
                                        :class="{ active: cleanupOperation.goldRush }"
                                        @click="toggleCleanupOperation('goldRush')">
                                        Ê∑òÈáëÁãÇÁÉ≠<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">350
                                    </button>
                                    <button 
                                        class="cleanup-operation-btn" 
                                        :class="{ active: cleanupOperation.ominousSeed }"
                                        @click="toggleCleanupOperation('ominousSeed')">
                                        ÊÅ∂ÂÖÜ‰πãÁßç<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">350
                                    </button>
                                </div>
                            </div>

                            <!-- Â∏ïÂ∞îÈ©¨Â∫üÂ¢ü -->
                            <div class="sub-section">
                                <div class="section-header">
                                    <h3 class="sub-title">Â∏ïÂ∞îÈ©¨Â∫üÂ¢ü</h3>
                                    <div class="module-switch">
                                        <label class="switch">
                                            <input type="checkbox" v-model="moduleEnabled.palmaRuins">
                                            <span class="slider"></span>
                                        </label>
                                        <span class="module-switch-label">{{ moduleEnabled.palmaRuins ? 'ËÆ°ÁÆóÊ≠§Ê®°Âùó' : '‰∏çËÆ°ÁÆóÊ≠§Ê®°Âùó' }}</span>
                                    </div>
                                </div>
                                <div class="palma-ruins-buttons">
                                    <div class="palma-ruins-row">
                                        <button 
                                            class="palma-ruins-btn" 
                                            :class="{ active: palmaRuins.tenacious }"
                                            @click="togglePalmaRuins('tenacious')">
                                            ÂùöÈüß<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">280
                                        </button>
                                        <button 
                                            class="palma-ruins-btn" 
                                            :class="{ active: palmaRuins.berserk }"
                                            @click="togglePalmaRuins('berserk')">
                                            ÁãÇÊö¥<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">280
                                        </button>
                                    </div>
                                    <div class="palma-ruins-row">
                                        <button 
                                            class="palma-ruins-btn" 
                                            :class="{ active: palmaRuins.mysterious }"
                                            @click="togglePalmaRuins('mysterious')">
                                            ËØ°Áßò<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">280
                                        </button>
                                        <button 
                                            class="palma-ruins-btn" 
                                            :class="{ active: palmaRuins.precise }"
                                            @click="togglePalmaRuins('precise')">
                                            Á≤æÂáÜ<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">280
                                        </button>
                                    </div>
                                    <div class="palma-ruins-row">
                                        <button 
                                            class="palma-ruins-btn" 
                                            :class="{ active: palmaRuins.supernatural }"
                                            @click="togglePalmaRuins('supernatural')">
                                            ÂºÇËÉΩ<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">280
                                        </button>
                                        <button 
                                            class="palma-ruins-btn" 
                                            :class="{ active: palmaRuins.inspiration }"
                                            @click="togglePalmaRuins('inspiration')">
                                            ÂêØËø™<img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂">280
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Êñ∞Â¢ûÔºöÊ∞™ÈáëËµÑÊ∫êÊ®°Âùó -->
                    <div class="recharge-section card new-module-section">
                        <h2 @click="toggleSection('recharge')" class="section-header">
                            üí≥ Ê∞™ÈáëËµÑÊ∫ê
                            <span class="collapse-icon">{{ sections.recharge ? '‚àí' : '+' }}</span>
                        </h2>
                        <div v-if="sections.recharge" class="section-content">
                            <div class="sub-section">
                                <h3 class="sub-title">ÂÖÖÂÄºÈÄâÈ°π</h3>
                                <div class="resource-vertical">
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> ÂÖÖÂÄºÂºÇÊñπÊô∂Ôºö
                                        </label>
                                        <input type="number" v-model.number="rechargeResources.crystal" placeholder="0" min="0">
                                    </div>
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§"> ÂÖÖÂÄºÊêúÁ¥¢‰ª§Ôºö
                                        </label>
                                        <input type="number" v-model.number="rechargeResources.tickets" placeholder="0" min="0">
                                    </div>
                                    <div class="resource-input-vertical">
                                        <label>ÂÖÖÂÄºÈáëÈ¢ùÔºàÂÖÉÔºâÔºö</label>
                                        <input type="number" v-model.number="rechargeResources.money" placeholder="0" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Êñ∞Â¢ûÔºöÂÖ∂‰ªñÔºà‰º∞ÁÆóÔºâÊ®°Âùó -->
                    <div class="other-section card new-module-section">
                        <h2 @click="toggleSection('other')" class="section-header">
                            üìù ÂÖ∂‰ªñÔºà‰º∞ÁÆóÔºâ
                            <span class="collapse-icon">{{ sections.other ? '‚àí' : '+' }}</span>
                        </h2>
                        <div v-if="sections.other" class="section-content">
                            <div class="sub-section">
                                <h3 class="sub-title">ÂÖ∂‰ªñËµÑÊ∫ê‰º∞ÁÆó</h3>
                                <div class="resource-vertical">
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/crystal.png" class="resource-icon" alt="ÂºÇÊñπÊô∂"> ÂÖ∂‰ªñÂºÇÊñπÊô∂Ôºö
                                        </label>
                                        <input type="number" v-model.number="otherResources.crystal" placeholder="0" min="0">
                                    </div>
                                    <div class="resource-input-vertical">
                                        <label>
                                            <img src="icons/ticket.png" class="resource-icon" alt="ÊêúÁ¥¢‰ª§"> ÂÖ∂‰ªñÊêúÁ¥¢‰ª§Ôºö
                                        </label>
                                        <input type="number" v-model.number="otherResources.tickets" placeholder="0" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        
        createApp({
            name: 'GachaCalculator',
            data() {
                const savedData = JSON.parse(localStorage.getItem('gachaCalculatorData')) || {};
                
                return {
                    // ÂõæÊ†áË∑ØÂæÑ
                    crystalIcon: 'icons/crystal.png',
                    ticketIcon: 'icons/ticket.png',
                    redCrystalIcon: 'icons/red_crystal.png',
                    premiumCrystalIcon: 'icons/premium_crystal.png',
                    yellowTicketIcon: 'icons/yellow_ticket.png',
                    hlIcon: 'icons/hl.gif',
                    
                    // È•ºÁä∂ÂõæÈ¢úËâ≤
                    categoryColors: ['#1890ff', '#52c41a', '#faad14', '#722ed1', '#eb2f96', '#13c2c2'],
                    
                    // Êñ∞Â¢ûÊ®°ÂùóÊï∞ÊçÆ
                    activityResources: savedData.activityResources || {
                        crystal: 0,
                        tickets: 0
                    },
                    rechargeResources: savedData.rechargeResources || {
                        crystal: 0,
                        tickets: 0,
                        money: 0
                    },
                    otherResources: savedData.otherResources || {
                        crystal: 0,
                        tickets: 0
                    },
                    
                    // ÊäòÂè†Èù¢ÊùøÁä∂ÊÄÅ
                    sections: {
                        timeTotal: true,
                        resources: true,
                        daily: true,
                        activity: true,
                        potential: true,
                        recharge: true,
                        other: true
                    },
                    
                    // ÂéüÊúâÊï∞ÊçÆ‰øùÊåÅ‰∏çÂèò
                    resources: savedData.resources || {
                        crystal: 0,
                        premiumCrystal: 0,
                        tickets: 0
                    },
                    selectedTime: savedData.selectedTime || 'nextVersion',
                    calculateToPoolEnd: savedData.calculateToPoolEnd || false,
                    weeklyCompleted: savedData.weeklyCompleted || false,
                    darkZoneSweepOnly: savedData.darkZoneSweepOnly || false,
                    darkZoneCompleted: savedData.darkZoneCompleted || false,
                    darkZoneFirstCompleted: savedData.darkZoneFirstCompleted || false,
                    trackingExchanged: savedData.trackingExchanged || false,
                    friendshipExchanged: savedData.friendshipExchanged || false,
                    usePremiumCrystal: savedData.usePremiumCrystal || false,
                    skinReserve: savedData.skinReserve || {
                        skin880: 0,
                        skin1280: 0,
                        skin2580: 0
                    },
                    customAdjustment: savedData.customAdjustment || 0,
                    versionWeeks: 4,
                    
                    emotionDetectionCompleted: savedData.emotionDetectionCompleted || false,
                    dailyShareCompleted: savedData.dailyShareCompleted || false,
                    trackingCertificationCount: savedData.trackingCertificationCount || 0,
                    useTrackingCertification: savedData.useTrackingCertification || false,
                    trainingModes: savedData.trainingModes || {
                        steady: false,
                        fluctuating: false,
                        outOfControl: false,
                        crazy: false
                    },
                    
                    nightmareScore: savedData.nightmareScore || 0,
                    nightmareSeaCompleted: savedData.nightmareSeaCompleted || false,
                    
                    dataGap: savedData.dataGap || {
                        targets: {
                            missionComplete: false,
                            missionCount: false,
                            targetComplete: false
                        },
                        ratings: {
                            healing: false,
                            shield: false,
                            controlTime: false,
                            controlCount: false,
                            totalDamage: false,
                            coreDamage: false,
                            comprehensive: false
                        }
                    },

                    // ÂÖ∂‰ªñÊ®°ÂùóÊï∞ÊçÆ‰øùÊåÅ‰∏çÂèò
                    mainStory: savedData.mainStory || {
                        chaosBeyondA: false,
                        chaosBeyondB: false,
                        unownedCavernA: false,
                        unownedCavernB: false,
                        kiranSquareA: false,
                        kiranSquareB: false,
                        carnivalA: false,
                        carnivalB: false,
                        refugeeCampA: false,
                        refugeeCampB: false,
                        muddyDarkTrapA: false,
                        muddyDarkTrapB: false,
                        highTowerBlackRing: false,
                        darkSurgeA: false,
                        darkSurgeB: false,
                        goldFeastA: false,
                        goldFeastB: false
                    },
                    darkShadowEx: savedData.darkShadowEx || {
                        chaosBeyond: false,
                        unownedCavern: false,
                        kiranSquare: false,
                        carnival: false,
                        highTowerBlackRing: false,
                        luxuryFeastFog: false,
                        drowningRainCity: false,
                        goldFeast: false
                    },
                    memoryStorm: savedData.memoryStorm || {
                        memoryAnomaly: false,
                        impressionAnomaly: false,
                        echoAnomaly: false
                    },
                    pollutionNest: savedData.pollutionNest || {
                        forbiddenZoneProbe: false,
                        extremeDomainSearch: false
                    },
                    cleanupOperation: savedData.cleanupOperation || {
                        goldRush: false,
                        ominousSeed: false
                    },
                    palmaRuins: savedData.palmaRuins || {
                        tenacious: false,
                        berserk: false,
                        mysterious: false,
                        precise: false,
                        supernatural: false,
                        inspiration: false
                    },
                    characterDevelopment: savedData.characterDevelopment || {
                        tier3: 0,
                        maxReverbS: 0,
                        maxReverbA: 0,
                        maxReverbB: 0,
                        reviewS: 0,
                        reviewA: 0,
                        haila: false
                    },
                    moduleEnabled: savedData.moduleEnabled || {
                        nightmare: true,
                        characterDevelopment: true,
                        mainStory: true,
                        darkShadowEx: true,
                        memoryStorm: true,
                        pollutionNest: true,
                        cleanupOperation: true,
                        palmaRuins: true
                    },
                    
                    nightmareRewards: [
                        { score: 1000, crystal: 100, tickets: 0 },
                        { score: 2000, crystal: 0, tickets: 1 },
                        { score: 3000, crystal: 150, tickets: 0 },
                        { score: 4000, crystal: 0, tickets: 1 },
                        { score: 5000, crystal: 150, tickets: 0 },
                        { score: 6000, crystal: 200, tickets: 0 },
                        { score: 7000, crystal: 200, tickets: 0 },
                        { score: 8000, crystal: 0, tickets: 1 },
                        { score: 10000, crystal: 100, tickets: 0 },
                        { score: 12000, crystal: 100, tickets: 0 },
                        { score: 14000, crystal: 100, tickets: 0 },
                        { score: 16000, crystal: 100, tickets: 0 },
                        { score: 18000, crystal: 100, tickets: 0 },
                        { score: 20000, crystal: 100, tickets: 0 },
                        { score: 22000, crystal: 100, tickets: 0 },
                        { score: 24000, crystal: 0, tickets: 1 },
                        { score: 26000, crystal: 100, tickets: 0 },
                        { score: 28000, crystal: 100, tickets: 0 },
                        { score: 30000, crystal: 100, tickets: 0 },
                        { score: 32000, crystal: 100, tickets: 0 },
                        { score: 34000, crystal: 100, tickets: 0 },
                        { score: 36000, crystal: 0, tickets: 1 },
                        { score: 38000, crystal: 100, tickets: 0 },
                        { score: 40000, crystal: 100, tickets: 0 },
                        { score: 42000, crystal: 100, tickets: 0 },
                        { score: 44000, crystal: 100, tickets: 0 },
                        { score: 46000, crystal: 100, tickets: 0 },
                        { score: 48000, crystal: 0, tickets: 1 },
                        { score: 50000, crystal: 100, tickets: 0 },
                        { score: 52000, crystal: 100, tickets: 0 },
                        { score: 54000, crystal: 100, tickets: 0 },
                        { score: 56000, crystal: 100, tickets: 0 },
                        { score: 58000, crystal: 100, tickets: 0 },
                        { score: 60000, crystal: 0, tickets: 1 }
                    ]
                }
            },
            computed: {
                // ÁßªÂä®Á´ØÊ£ÄÊµã
                isMobile() {
                    return window.innerWidth <= 768;
                },
                
                // ÂàÜÁ±ªÊ±áÊÄªËÆ°ÁÆó
                summaryCategories() {
                    const categories = [
                        {
                            key: 'current',
                            label: 'Áé∞Êúâ',
                            crystal: this.currentCrystalTotal,
                            tickets: this.currentTicketsTotal,
                            pulls: this.currentPulls
                        },
                        {
                            key: 'daily',
                            label: 'Êó•Â∏∏',
                            crystal: this.dailyCrystalTotal,
                            tickets: this.dailyTicketsTotal,
                            pulls: this.dailyPulls
                        },
                        {
                            key: 'activity',
                            label: 'Ê¥ªÂä®',
                            crystal: this.activityCrystalTotal,
                            tickets: this.activityTicketsTotal,
                            pulls: this.activityPulls
                        },
                        {
                            key: 'potential',
                            label: 'ÊΩúÂú®',
                            crystal: this.potentialCrystalTotal,
                            tickets: this.potentialTicketsTotal,
                            pulls: this.potentialPulls
                        },
                        {
                            key: 'recharge',
                            label: 'Ê∞™Èáë',
                            crystal: this.rechargeCrystalTotal,
                            tickets: this.rechargeTicketsTotal,
                            pulls: this.rechargePulls
                        },
                        {
                            key: 'other',
                            label: 'ÂÖ∂‰ªñ',
                            crystal: this.otherCrystalTotal,
                            tickets: this.otherTicketsTotal,
                            pulls: this.otherPulls
                        }
                    ];

                    const totalPulls = this.totalPulls;
                    
                    // ËÆ°ÁÆóÁôæÂàÜÊØî
                    categories.forEach(category => {
                        category.percentage = totalPulls > 0 ? 
                            ((category.pulls / totalPulls) * 100).toFixed(1) : '0.0';
                    });

                    return categories;
                },

                // ÂêÑ‰∏™ÂàÜÁ±ªÁöÑÊäΩÊï∞ËÆ°ÁÆó
                currentPulls() {
                    const crystal = this.currentCrystalTotal;
                    const tickets = this.currentTicketsTotal;
                    return Math.floor(crystal / 180) + tickets;
                },

                dailyPulls() {
                    const crystal = this.dailyCrystalTotal;
                    const tickets = this.dailyTicketsTotal;
                    return Math.floor(crystal / 180) + tickets;
                },

                activityPulls() {
                    const crystal = this.activityCrystalTotal;
                    const tickets = this.activityTicketsTotal;
                    return Math.floor(crystal / 180) + tickets;
                },

                potentialPulls() {
                    const crystal = this.potentialCrystalTotal;
                    const tickets = this.potentialTicketsTotal;
                    return Math.floor(crystal / 180) + tickets;
                },

                rechargePulls() {
                    const crystal = this.rechargeCrystalTotal;
                    const tickets = this.rechargeTicketsTotal;
                    return Math.floor(crystal / 180) + tickets;
                },

                otherPulls() {
                    const crystal = this.otherCrystalTotal;
                    const tickets = this.otherTicketsTotal;
                    return Math.floor(crystal / 180) + tickets;
                },

                // ÂêÑ‰∏™ÂàÜÁ±ªÁöÑÂºÇÊñπÊô∂ÂíåÊêúÁ¥¢‰ª§ËÆ°ÁÆó
                currentCrystalTotal() {
                    const crystal = this.resources.crystal || 0;
                    const premiumCrystal = this.usePremiumCrystal ? (this.resources.premiumCrystal || 0) : 0;
                    return crystal + premiumCrystal - this.totalSkinReserve + this.customAdjustment;
                },

                currentTicketsTotal() {
                    return this.resources.tickets || 0;
                },

                dailyCrystalTotal() {
                    // Êó•Â∏∏ÁßØÁ¥ØÊ®°ÂùóÁöÑÂºÇÊñπÊô∂ËÆ°ÁÆó
                    return this.dailyActiveTotal + 
                           this.totalWeeklyActive + 
                           this.totalDarkZone +
                           this.totalDarkZoneFirst +
                           this.totalEmotionDetection +
                           this.totalDailyShare +
                           this.totalTrackingCertification +
                           this.trainingRewards.crystal +
                           this.dataGapRewards;
                },

                dailyTicketsTotal() {
                    // Êó•Â∏∏ÁßØÁ¥ØÊ®°ÂùóÁöÑÊêúÁ¥¢‰ª§ËÆ°ÁÆó
                    return this.totalTrackingExchange + 
                           this.totalFriendshipExchange + 
                           this.totalEmotionDetectionTickets +
                           this.totalTrackingCertificationTickets +
                           this.trainingRewards.tickets;
                },

                activityCrystalTotal() {
                    return this.activityResources.crystal || 0;
                },

                activityTicketsTotal() {
                    return this.activityResources.tickets || 0;
                },

                potentialCrystalTotal() {
                    // ÊΩúÂú®ËµÑÊ∫êÊ®°ÂùóÁöÑÂºÇÊñπÊô∂ËÆ°ÁÆó
                    return (this.moduleEnabled.nightmare ? this.nightmareTotalRewards.crystal : 0) + 
                           this.characterDevelopmentRewards.crystal + 
                           this.mainStoryRewards.crystal + 
                           this.darkShadowExRewards + 
                           this.memoryStormRewards + 
                           this.pollutionNestRewards + 
                           this.cleanupOperationRewards + 
                           this.palmaRuinsRewards;
                },

                potentialTicketsTotal() {
                    // ÊΩúÂú®ËµÑÊ∫êÊ®°ÂùóÁöÑÊêúÁ¥¢‰ª§ËÆ°ÁÆó
                    return (this.moduleEnabled.nightmare ? this.nightmareTotalRewards.tickets : 0) + 
                           this.mainStoryRewards.tickets;
                },

                rechargeCrystalTotal() {
                    return this.rechargeResources.crystal || 0;
                },

                rechargeTicketsTotal() {
                    return this.rechargeResources.tickets || 0;
                },

                otherCrystalTotal() {
                    return this.otherResources.crystal || 0;
                },

                otherTicketsTotal() {
                    return this.otherResources.tickets || 0;
                },

                // ÊÄªÊäΩÊï∞ÂíåÈáëÈ¢ù
                totalPulls() {
                    return this.currentPulls + 
                           this.dailyPulls + 
                           this.activityPulls + 
                           this.potentialPulls + 
                           this.rechargePulls + 
                           this.otherPulls;
                },

                totalMoney() {
                    return this.rechargeResources.money || 0;
                },

                // ÂéüÊúâËÆ°ÁÆóÂ±ûÊÄß‰øùÊåÅ‰∏çÂèò
                daysToNextVersion() {
                    const today = new Date();
                    const targetDate = new Date(2025, 10, 20);
                    const diffTime = targetDate - today;
                    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                },
                
                daysToNewYear() {
                    const today = new Date();
                    const targetDate = new Date(2026, 1, 17);
                    const diffTime = targetDate - today;
                    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                },
                
                selectedDays() {
                    const baseDays = this.selectedTime === 'nextVersion' 
                        ? this.daysToNextVersion 
                        : this.daysToNewYear;
                    return this.calculateToPoolEnd ? baseDays + (this.versionWeeks * 7) : baseDays;
                },
                
                weeklyCount() {
                    return Math.ceil(this.selectedDays / 7);
                },
                
                remainingWeeklyCount() {
                    return this.weeklyCompleted ? this.weeklyCount - 1 : this.weeklyCount;
                },
                
                remainingShareWeeks() {
                    return this.dailyShareCompleted ? this.weeklyCount - 1 : this.weeklyCount;
                },
                
                remainingShareTotal() {
                    return 60 * this.remainingShareWeeks;
                },
                
                remainingDarkZoneWeeks() {
                    return this.darkZoneCompleted ? this.weeklyCount - 1 : this.weeklyCount;
                },
                
                darkZonePerWeek() {
                    return this.darkZoneSweepOnly ? 450 : 510;
                },
                
                dailyActiveTotal() {
                    return 40 * this.selectedDays;
                },
                
                remainingWeeklyTotal() {
                    return 150 * this.remainingWeeklyCount;
                },
                
                remainingDarkZoneTotal() {
                    return this.darkZonePerWeek * this.remainingDarkZoneWeeks;
                },
                
                remainingTrackingExchange() {
                    return this.trackingExchanged ? 0 : 5;
                },
                
                remainingFriendshipExchange() {
                    return this.friendshipExchanged ? 0 : 3;
                },
                
                trackingCertificationTickets() {
                    return this.useTrackingCertification ? this.trackingCertificationCount : 0;
                },
                
                totalSkinReserve() {
                    return (this.skinReserve.skin880 * 880) + 
                           (this.skinReserve.skin1280 * 1280) + 
                           (this.skinReserve.skin2580 * 2580);
                },
                
                totalWeeklyActive() {
                    const actualWeeks = this.weeklyCompleted ? this.weeklyCount - 1 : this.weeklyCount;
                    return 150 * actualWeeks;
                },
                
                totalDarkZone() {
                    const actualWeeks = this.darkZoneCompleted ? this.weeklyCount - 1 : this.weeklyCount;
                    return this.darkZonePerWeek * actualWeeks;
                },
                
                totalDarkZoneFirst() {
                    return this.darkZoneFirstCompleted ? 0 : 450;
                },
                
                totalEmotionDetection() {
                    return this.emotionDetectionCompleted ? 0 : 50;
                },
                
                totalEmotionDetectionTickets() {
                    return this.emotionDetectionCompleted ? 0 : 1;
                },
                
                totalDailyShare() {
                    const actualWeeks = this.dailyShareCompleted ? this.weeklyCount - 1 : this.weeklyCount;
                    return 60 * actualWeeks;
                },
                
                totalTrackingExchange() {
                    return this.trackingExchanged ? 0 : 5;
                },
                
                totalFriendshipExchange() {
                    return this.friendshipExchanged ? 0 : 3;
                },
                
                totalTrackingCertification() {
                    return this.useTrackingCertification ? (this.trackingCertificationCount * 180) : 0;
                },
                
                totalTrackingCertificationTickets() {
                    return this.useTrackingCertification ? this.trackingCertificationCount : 0;
                },
                
                trainingRewards() {
                    let crystal = 0;
                    let tickets = 0;
                    
                    if (this.trainingModes.steady) {
                        crystal += 100;
                        tickets += 1;
                    }
                    if (this.trainingModes.fluctuating) {
                        crystal += 200;
                        tickets += 2;
                    }
                    if (this.trainingModes.outOfControl) {
                        crystal += 200;
                    }
                    if (this.trainingModes.crazy) {
                        crystal += 60;
                    }
                    
                    return {
                        crystal,
                        tickets,
                        total: crystal + (tickets * 180)
                    };
                },
                
                dataGapRewards() {
                    let crystal = 0;
                    
                    if (this.dataGap.targets.missionComplete) crystal += 300;
                    if (this.dataGap.targets.missionCount) crystal += 120;
                    if (this.dataGap.targets.targetComplete) crystal += 140;
                    
                    if (this.dataGap.ratings.healing) crystal += 100;
                    if (this.dataGap.ratings.shield) crystal += 100;
                    if (this.dataGap.ratings.controlTime) crystal += 100;
                    if (this.dataGap.ratings.controlCount) crystal += 100;
                    if (this.dataGap.ratings.totalDamage) crystal += 100;
                    if (this.dataGap.ratings.coreDamage) crystal += 100;
                    if (this.dataGap.ratings.comprehensive) crystal += 100;
                    
                    return crystal;
                },

                nightmareCrystalReward() {
                    return this.calculateNightmareRewards().crystal;
                },
                
                nightmareTicketReward() {
                    return this.calculateNightmareRewards().tickets;
                },
                
                nightmareSeaReward() {
                    return this.nightmareSeaCompleted ? 0 : 930;
                },
                
                nightmareTotalRewards() {
                    const scoreRewards = this.calculateNightmareRewards();
                    return {
                        crystal: scoreRewards.crystal + this.nightmareSeaReward,
                        tickets: scoreRewards.tickets,
                        total: scoreRewards.crystal + this.nightmareSeaReward + (scoreRewards.tickets * 180)
                    };
                },

                characterDevelopmentRewards() {
                    if (!this.moduleEnabled.characterDevelopment) {
                        return { crystal: 0, total: 0 };
                    }

                    let crystal = 0;
                    
                    crystal += this.characterDevelopment.tier3 * 180;
                    crystal += this.characterDevelopment.maxReverbS * 210;
                    crystal += this.characterDevelopment.maxReverbA * 60;
                    crystal += this.characterDevelopment.maxReverbB * 20;
                    crystal += this.characterDevelopment.reviewS * 200;
                    crystal += this.characterDevelopment.reviewA * 150;
                    
                    // Ê≥®ÊÑèËøôÈáåÔºöÂè™ÊúâÂΩìÊµ∑ÊãâÊú™ÂÆ°Êü•Êó∂ÊâçËÆ°ÁÆóËµÑÊ∫ê
                    if (!this.characterDevelopment.haila) {
                        crystal += 100;
                    }
                    
                    return {
                        crystal,
                        total: crystal
                    };
                },

                mainStoryRewards() {
                    if (!this.moduleEnabled.mainStory) {
                        return { crystal: 0, tickets: 0, total: 0 };
                    }

                    let crystal = 0;
                    let tickets = 0;
                    
                    if (this.mainStory.chaosBeyondA) { crystal += 895; tickets += 1; }
                    if (this.mainStory.chaosBeyondB) { crystal += 1130; tickets += 1; }
                    if (this.mainStory.unownedCavernA) { crystal += 1075; tickets += 1; }
                    if (this.mainStory.unownedCavernB) { crystal += 1180; tickets += 1; }
                    if (this.mainStory.kiranSquareA) { crystal += 1165; tickets += 1; }
                    if (this.mainStory.kiranSquareB) { crystal += 1130; tickets += 1; }
                    if (this.mainStory.carnivalA) { crystal += 1130; tickets += 1; }
                    if (this.mainStory.carnivalB) { crystal += 835; tickets += 1; }
                    if (this.mainStory.refugeeCampA) { crystal += 1025; tickets += 1; }
                    if (this.mainStory.refugeeCampB) { crystal += 1095; tickets += 1; }
                    if (this.mainStory.muddyDarkTrapA) { crystal += 1130; tickets += 1; }
                    if (this.mainStory.muddyDarkTrapB) { crystal += 505; tickets += 1; }
                    if (this.mainStory.highTowerBlackRing) { crystal += 1880; tickets += 2; }
                    if (this.mainStory.darkSurgeA) { crystal += 905; tickets += 1; }
                    if (this.mainStory.darkSurgeB) { crystal += 905; tickets += 1; }
                    if (this.mainStory.goldFeastA) { crystal += 800; tickets += 1; }
                    if (this.mainStory.goldFeastB) { crystal += 1080; tickets += 1; }
                    
                    return {
                        crystal,
                        tickets,
                        total: crystal + (tickets * 180)
                    };
                },

                darkShadowExRewards() {
                    if (!this.moduleEnabled.darkShadowEx) {
                        return 0;
                    }

                    let crystal = 0;
                    
                    if (this.darkShadowEx.chaosBeyond) crystal += 720;
                    if (this.darkShadowEx.unownedCavern) crystal += 720;
                    if (this.darkShadowEx.kiranSquare) crystal += 590;
                    if (this.darkShadowEx.carnival) crystal += 650;
                    if (this.darkShadowEx.highTowerBlackRing) crystal += 650;
                    if (this.darkShadowEx.luxuryFeastFog) crystal += 650;
                    if (this.darkShadowEx.drowningRainCity) crystal += 650;
                    if (this.darkShadowEx.goldFeast) crystal += 650;
                    
                    return crystal;
                },

                memoryStormRewards() {
                    if (!this.moduleEnabled.memoryStorm) {
                        return 0;
                    }

                    let crystal = 0;
                    
                    if (this.memoryStorm.memoryAnomaly) crystal += 350;
                    if (this.memoryStorm.impressionAnomaly) crystal += 350;
                    if (this.memoryStorm.echoAnomaly) crystal += 350;
                    
                    return crystal;
                },

                pollutionNestRewards() {
                    if (!this.moduleEnabled.pollutionNest) {
                        return 0;
                    }

                    let crystal = 0;
                    
                    if (this.pollutionNest.forbiddenZoneProbe) crystal += 350;
                    if (this.pollutionNest.extremeDomainSearch) crystal += 210;
                    
                    return crystal;
                },

                cleanupOperationRewards() {
                    if (!this.moduleEnabled.cleanupOperation) {
                        return 0;
                    }

                    let crystal = 0;
                    
                    if (this.cleanupOperation.goldRush) crystal += 350;
                    if (this.cleanupOperation.ominousSeed) crystal += 350;
                    
                    return crystal;
                },

                palmaRuinsRewards() {
                    if (!this.moduleEnabled.palmaRuins) {
                        return 0;
                    }

                    let crystal = 0;
                    
                    if (this.palmaRuins.tenacious) crystal += 280;
                    if (this.palmaRuins.berserk) crystal += 280;
                    if (this.palmaRuins.mysterious) crystal += 280;
                    if (this.palmaRuins.precise) crystal += 280;
                    if (this.palmaRuins.supernatural) crystal += 280;
                    if (this.palmaRuins.inspiration) crystal += 280;
                    
                    return crystal;
                }
            },
            watch: {
                // Êñ∞Â¢ûÊ®°ÂùóÁöÑwatch
                activityResources: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                rechargeResources: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                otherResources: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                
                // ÂéüÊúâwatch‰øùÊåÅ‰∏çÂèòÔºå‰ΩÜÊ∑ªÂä†updateChartË∞ÉÁî®
                resources: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                selectedTime() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                calculateToPoolEnd() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                weeklyCompleted() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                darkZoneSweepOnly() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                darkZoneCompleted() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                darkZoneFirstCompleted() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                trackingExchanged() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                friendshipExchanged() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                usePremiumCrystal() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                skinReserve: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                customAdjustment() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                emotionDetectionCompleted() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                dailyShareCompleted() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                trackingCertificationCount() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                useTrackingCertification() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                trainingModes: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                nightmareScore() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                nightmareSeaCompleted() {
                    this.saveToLocalStorage();
                    this.updateChart();
                },
                dataGap: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                mainStory: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                darkShadowEx: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                memoryStorm: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                pollutionNest: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                cleanupOperation: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                palmaRuins: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                characterDevelopment: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                },
                moduleEnabled: {
                    handler(newValue) {
                        this.saveToLocalStorage();
                        this.updateChart();
                    },
                    deep: true
                }
            },
            mounted() {
                this.initChart();
                window.addEventListener('resize', this.handleResize);
            },
            beforeUnmount() {
                window.removeEventListener('resize', this.handleResize);
            },
            methods: {
                initChart() {
                    const ctx = this.$refs.pieChart.getContext('2d');
                    this.chart = new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: this.summaryCategories.map(cat => cat.label),
                            datasets: [{
                                data: this.summaryCategories.map(cat => cat.pulls),
                                backgroundColor: this.categoryColors,
                                borderWidth: 2,
                                borderColor: '#fff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        label: (context) => {
                                            const category = this.summaryCategories[context.dataIndex];
                                            return `${category.label}: ${category.pulls}ÊäΩ (${category.percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                },

                updateChart() {
                    if (this.chart) {
                        this.chart.data.datasets[0].data = this.summaryCategories.map(cat => cat.pulls);
                        this.chart.update();
                    }
                },

                showTooltip(category) {
                    const tooltip = this.$refs.chartTooltip;
                    tooltip.innerHTML = `${category.label}: ${category.pulls}ÊäΩ (${category.percentage}%)`;
                    tooltip.style.display = 'block';
                },

                hideTooltip() {
                    const tooltip = this.$refs.chartTooltip;
                    tooltip.style.display = 'none';
                },

                handleResize() {
                    this.updateChart();
                },

                formatNumber(num) {
                    return num.toLocaleString();
                },

                toggleSection(section) {
                    this.sections[section] = !this.sections[section];
                },

                adjustSkinCount(price, change) {
                    const skinKey = `skin${price}`;
                    if (this.skinReserve[skinKey] !== undefined) {
                        const newValue = this.skinReserve[skinKey] + change;
                        if (newValue >= 0) {
                            this.skinReserve[skinKey] = newValue;
                        }
                    }
                },

                adjustCertificationCount(change) {
                    const newValue = this.trackingCertificationCount + change;
                    if (newValue >= 0) {
                        this.trackingCertificationCount = newValue;
                    }
                },

                toggleTrainingMode(mode) {
                    this.trainingModes[mode] = !this.trainingModes[mode];
                },

                toggleDataGap(category, type) {
                    this.dataGap[category][type] = !this.dataGap[category][type];
                },

                toggleMainStory(type) {
                    this.mainStory[type] = !this.mainStory[type];
                },

                toggleDarkShadowEx(type) {
                    this.darkShadowEx[type] = !this.darkShadowEx[type];
                },

                toggleMemoryStorm(type) {
                    this.memoryStorm[type] = !this.memoryStorm[type];
                },

                togglePollutionNest(type) {
                    this.pollutionNest[type] = !this.pollutionNest[type];
                },

                toggleCleanupOperation(type) {
                    this.cleanupOperation[type] = !this.cleanupOperation[type];
                },

                togglePalmaRuins(type) {
                    this.palmaRuins[type] = !this.palmaRuins[type];
                },
                
                calculateNightmareRewards() {
                    let totalCrystal = 0;
                    let totalTickets = 0;
                    
                    for (const reward of this.nightmareRewards) {
                        if (reward.score > this.nightmareScore) {
                            totalCrystal += reward.crystal;
                            totalTickets += reward.tickets;
                        }
                    }
                    
                    return {
                        crystal: totalCrystal,
                        tickets: totalTickets
                    };
                },

                saveToLocalStorage() {
                    const dataToSave = {
                        // ÂéüÊúâÊï∞ÊçÆ
                        resources: this.resources,
                        selectedTime: this.selectedTime,
                        calculateToPoolEnd: this.calculateToPoolEnd,
                        weeklyCompleted: this.weeklyCompleted,
                        darkZoneSweepOnly: this.darkZoneSweepOnly,
                        darkZoneCompleted: this.darkZoneCompleted,
                        darkZoneFirstCompleted: this.darkZoneFirstCompleted,
                        trackingExchanged: this.trackingExchanged,
                        friendshipExchanged: this.friendshipExchanged,
                        usePremiumCrystal: this.usePremiumCrystal,
                        skinReserve: this.skinReserve,
                        customAdjustment: this.customAdjustment,
                        emotionDetectionCompleted: this.emotionDetectionCompleted,
                        dailyShareCompleted: this.dailyShareCompleted,
                        trackingCertificationCount: this.trackingCertificationCount,
                        useTrackingCertification: this.useTrackingCertification,
                        trainingModes: this.trainingModes,
                        nightmareScore: this.nightmareScore,
                        nightmareSeaCompleted: this.nightmareSeaCompleted,
                        dataGap: this.dataGap,
                        mainStory: this.mainStory,
                        darkShadowEx: this.darkShadowEx,
                        memoryStorm: this.memoryStorm,
                        pollutionNest: this.pollutionNest,
                        cleanupOperation: this.cleanupOperation,
                        palmaRuins: this.palmaRuins,
                        characterDevelopment: this.characterDevelopment,
                        moduleEnabled: this.moduleEnabled,
                        // Êñ∞Â¢ûÊ®°ÂùóÊï∞ÊçÆ
                        activityResources: this.activityResources,
                        rechargeResources: this.rechargeResources,
                        otherResources: this.otherResources
                    };
                    localStorage.setItem('gachaCalculatorData', JSON.stringify(dataToSave));
                }
            }
        }).mount('#app');
    </script>
</body>
</html>